mod from https://github.com/lucidrains/denoising-diffusion-pytorch